{% extends 'base.html' %}
{% block content %}

<div class="row-fluid">
  <div class="pets-section">
    <div class="pets-container">
      {% for pet in pets %}
        <div class="pet-item">
          {% if pet['photo_addr'] %}
            <img src="/{{ pet['photo_addr'] }}" alt="{{ pet['name'] }}" title="{{ pet['name'] }}" />
          {% else %}
            <div class="pet-placeholder">
              <span>ğŸ±</span>
            </div>
          {% endif %}
          <span class="pet-name">{{ pet['name'] }}</span>
        </div>
      {% endfor %}
    </div>
    <a href="/events/day" class="calendar-icon-link" aria-label="View day events">
      <svg class="calendar-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect x="3" y="4" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2" fill="none"/>
        <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
        <circle cx="12" cy="15" r="1" fill="currentColor"/>
        <circle cx="16" cy="15" r="1" fill="currentColor"/>
        <circle cx="20" cy="15" r="1" fill="currentColor"/>
      </svg>
    </a>
  </div>

  {% if error %}
    <div class="error">{{ error }}</div>
  {% endif %}
  {% if created %}
    <div class="success">
      Event created successfully!
    </div>
  {% endif %}
  <div>
    <form action="/events/new" method="get" class="new-event">
      <button type="submit" aria-label="Add new event">Add Event</button>
    </form>
  </div>
  <table role="table" aria-label="Events table">
    <thead>
      <tr>
        <th scope="col">Type</th>
        <th scope="col">Pet</th>
        <th scope="col">Meta</th>
        <th scope="col">Time</th>
      </tr>
    </thead>
    <tbody>
    {% for event in events %}
      <tr data-event-type="{{ event['type'] }}">
        <td class="event-type-icon">
          <img src="/assets/{{ event['type'] }}Icon.svg" alt="{{ event['type'] }}" title="{{ event['type'] }}" aria-label="{{ event['type'] }} event type icon" class="event-icon" />
        </td>
        <td class="event-pet-icon">
          {%if event['pet-name'] %}
            <img src="/{{ event['pet-icon'] }}" alt="{{ event['pet-name'] }}" title="{{ event['pet-name'] }}" aria-label="{{ event['pet-name'] }} pet icon" class="event-icon" />
          {% endif %}
        </td>
        <td>
          {%if event['meta'] %}
            {% if event['meta'] is mapping %}
              {% if event['type'] == 'Food' and event['meta'].get('name') %}
                {{ event['meta']['name'] }}
              {% elif event['type'] == 'Medicine' and event['meta'].get('name') %}
                {{ event['meta']['name'] }}
              {% else %}
                {{ event['meta'] }}
              {% endif %}
            {% else %}
              {{ event['meta'] }}
            {% endif %}
          {% endif %}
        </td>
        <td>
          {{ event['time_ago'] }}
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
</div>


{% endblock %}
